<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Study Scheduler â€¢ Login</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    .login-card { max-width: 420px; margin: 10vh auto; }
  </style>
</head>
<body>
  <header class="app-header">
    <div class="brand">ðŸ“š Study Scheduler</div>
    <nav class="tabs">
      <a class="tab-button" href="index.html">Dashboard</a>
      <a class="tab-button" href="schedule.html">Schedule</a>
      <a class="tab-button" href="goals.html">Goals</a>
      <a class="tab-button" href="friends.html">Friends</a>
    </nav>
  </header>

  <main>
    <div class="card login-card">
      <h2>Login</h2>
      <p class="muted">Use the default user for now: <code>test-user</code> / <code>password</code></p>
      <form id="login-form" class="stack">
        <label class="stack small">
          <span>Username</span>
          <input id="username" type="text" placeholder="test-user" value="test-user" required />
        </label>
        <label class="stack small">
          <span>Password</span>
          <input id="password" type="password" placeholder="password" value="password" required />
        </label>
        <div class="row end">
          <button type="submit" class="primary">Login</button>
        </div>
        <div id="error" class="muted" style="color:#b00020;"></div>
      </form>
    </div>
  </main>

  <script>
    const BACKEND_URL = 'http://localhost:5000';
    const form = document.getElementById('login-form');
    const err = document.getElementById('error');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      err.textContent = '';
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value;
      try {
        const res = await fetch(`${BACKEND_URL}/api/login`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          credentials: 'include',
          body: JSON.stringify({ username, password })
        });
        if (!res.ok) {
          const j = await res.json().catch(() => ({}));
          throw new Error(j.error || `Login failed (${res.status})`);
        }
        // On success, go to dashboard
        window.location.href = 'index.html';
      } catch (e) {
        err.textContent = e.message || String(e);
      }
    });
  </script>
</body>
</html>
